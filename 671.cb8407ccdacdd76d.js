"use strict";(self.webpackChunkelearnWeb=self.webpackChunkelearnWeb||[]).push([[671],{9671:(P,S,h)=>{h.d(S,{Ci:()=>c,QJ:()=>W,yQ:()=>U});var n=h(5e3),a=h(9808),u=h(591),g=h(7739),C=h(13),I=h(5778);function _(i,s){1&i&&n._UZ(0,"i",4)}function v(i,s){1&i&&n._UZ(0,"i",5)}function k(i,s){if(1&i&&(n.ynx(0),n.YNc(1,_,1,0,"i",2),n.YNc(2,v,1,0,"i",3),n.BQk()),2&i){const e=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!e.state.expanded),n.xp6(1),n.Q6J("ngIf",e.state.expanded)}}function x(i,s){if(1&i&&(n.ynx(0),n.YNc(1,k,3,2,"ng-container",1),n.BQk()),2&i){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",(null==e.state.nodeItem||null==e.state.nodeItem.children?null:e.state.nodeItem.children.length)>0)}}function T(i,s){1&i&&n.GkF(0)}const N=function(i,s){return{expanded:i,context:s}};function b(i,s){if(1&i&&(n.ynx(0),n.YNc(1,T,1,0,"ng-container",6),n.BQk()),2&i){const e=n.oxw();n.xp6(1),n.Q6J("ngTemplateOutlet",e.nodeCollapsibleTemplate)("ngTemplateOutletContext",n.WLB(2,N,e.state.expanded,e._this))}}function y(i,s){if(1&i&&(n.ynx(0),n.TgZ(1,"span"),n._uU(2),n.qZA(),n.BQk()),2&i){const e=n.oxw();n.xp6(1),n.ekj("active",e.active),n.xp6(1),n.Oqu(e.state.nodeItem.name)}}function B(i,s){1&i&&n.GkF(0)}const O=function(i,s,e){return{$implicit:i,node:s,context:e}},w=["nodeCheckbox"];function E(i,s){if(1&i){const e=n.EpF();n.TgZ(0,"input",6,7),n.NdJ("click",function(){n.CHM(e);const l=n.oxw();return n.KtG(l.checkBoxClick())}),n.qZA()}if(2&i){const e=n.oxw();n.Q6J("disabled",e.state.disabled)("checked",e.state.selected)}}function M(i,s){if(1&i&&n._UZ(0,"node",11),2&i){const e=s.$implicit,t=n.oxw(2);n.Q6J("state",e)("selectedState",e.selectedState)("nodeCollapsibleTemplate",t.nodeCollapsibleTemplate)("nodeNameTemplate",t.nodeNameTemplate)}}function Q(i,s){if(1&i&&(n.TgZ(0,"div",8)(1,"div",9),n.YNc(2,M,1,4,"node",10),n.qZA()()),2&i){const e=n.oxw();n.ekj("collapsed",!e.state.expanded&&e.state.nodeItem.children.length>0&&e.state.filteredChildren.length>0),n.xp6(2),n.Q6J("ngForOf",e.state.filteredChildren)}}const F=["nodeNameTemplate"],A=["nodeCollapsibleTemplate"];function D(i,s){if(1&i&&n._UZ(0,"node",2),2&i){const e=s.$implicit,t=n.oxw();n.Q6J("state",e)("selectedState",e.selectedState)("nodeCollapsibleTemplate",t.nodeCollapsibleTemplate)("nodeNameTemplate",t.nodeNameTemplate)}}var o=(()=>{return(i=o||(o={}))[i.checked=0]="checked",i[i.unChecked=1]="unChecked",i[i.indeterminate=2]="indeterminate",o;var i})(),c=(()=>{return(i=c||(c={}))[i.NoSelect=0]="NoSelect",i[i.SingleSelect=1]="SingleSelect",i[i.MultiSelect=2]="MultiSelect",i[i.HideSelected=3]="HideSelected",c;var i})();class f{static initState(s,e,t){return{parent:s,children:[],filteredChildren:[],hasFilteredChildren:!1,nodeItem:e,expanded:!1!==e.expanded,disabled:!0===e.disabled,markSelected:this.getMarkSelected(e,t),selectedState:o.unChecked,selected:!1,showCheckBox:t.checkboxes}}static getMarkSelected(s,e){return!(s.children&&0!==s.children.length&&e.mode!==c.SingleSelect||e.checkboxes)}}let p=(()=>{class i{constructor(){this.callbacks={},this.treeState=[],this.selectedItems=[],this.selectedStates=[],this.filterValue="",this.selectedItemsSubject=new u.X(this.selectedItems),this.filterChangeSubject=new u.X(this.filterValue),this.filterChangeSubject.pipe((0,C.b)(300),(0,I.x)()).subscribe(e=>{this.filterTraverse(this.treeState,this.filterValue)})}toggleSelected(e){this.toggleSelectedState(e,!1),this.callbacks.toggle&&this.callbacks.toggle(e.nodeItem)}toggleSelectedState(e,t){this.isDisabled(e,t)||(e.selectedState===o.unChecked?this.options.mode===c.SingleSelect?(this.clear(),this.setChecked(e,!1,!0,t)):this.setChecked(e,!0,!1,t):e.selectedState===o.checked?this.options.mode===c.SingleSelect?this.setUnchecked(e,!1,!0,t):this.setUnchecked(e,!0,!1,t):this.anyActiveSelected(e)&&!e.selected?this.setUnchecked(e,!0,!1,t):this.setChecked(e,!0,!1,t),e.parent&&this.options.mode!==c.SingleSelect&&this.childStateChanged(e.parent))}setInitialState(){this.setInitialSelectedState(this.treeState)}childStateChanged(e){this.anyChildSelected(e)?this.allChildrenSelected(e)?this.setChecked(e,!1):this.setIndeterminate(e):this.setUnchecked(e,!1),e.parent&&this.childStateChanged(e.parent)}checkBoxClick(e){this.options.mode!==c.HideSelected&&this.toggleSelected(e)}nameClick(e){this.callbacks.nameClick&&this.callbacks.nameClick(e.nodeItem),this.canToggleChildrenOnName()&&this.toggleSelected(e)}toggleExpanded(e){this.toggleExpandedTraverse(this.treeState,e)}clear(){for(let e of this.selectedStates)e.selected=!1,e.selectedState=o.unChecked;this.selectedItems.length=0,this.selectedStates.length=0}addNodeById(e,t){let l=this.getNodeState(this.treeState,t,this.findById);l&&(l.children||(l.children=[]),this.addNewNode(e,l),l.nodeItem.item&&this.options.mode===c.MultiSelect&&this.removeSelected(l.nodeItem.item))}selectById(e){let t=this.getNodeState(this.treeState,e,this.findById);t&&this.toggleSelected(t)}editNameById(e,t){const l=this.getNodeState(this.treeState,e,this.findById);l&&l.nodeItem&&(l.nodeItem.name=t)}editItemById(e,t){const l=this.getNodeState(this.treeState,e,this.findById);l&&l.nodeItem&&(this.selectedItems.includes(l.nodeItem.item)&&(this.removeSelected(l.nodeItem.item),this.selectedItems.push(t),this.selectedItemsSubject.next(this.selectedItems)),l.nodeItem.item=t)}deleteById(e){let t=this.getNodeState(this.treeState,e,this.findById);t&&this.deleteByState(t)}deleteByState(e){this.delete(e),this.childStateChanged(e),this.filterTraverse(this.treeState,this.filterValue)}expandById(e){const t=this.getNodeState(this.treeState,e,this.findById);t&&this.toggleExpandedTraverseAsc(t,!0)}collapseById(e){const t=this.getNodeState(this.treeState,e,this.findById);t&&(t.expanded=!1)}reEvaluateSelectedState(e){if(this.options.mode!==c.SingleSelect&&!this.hasNoChildren(e)){this.childStateChanged(e);for(const t of e.children)this.reEvaluateSelectedState(t)}}filterChanged(e){this.filterValue=e,this.filterChangeSubject.next(e)}canToggleChildrenOnName(){return!1===this.options.checkboxes&&(this.options.mode===c.SingleSelect||this.options.mode===c.MultiSelect)}getParentById(e){const t=this.getNodeState(this.treeState,e,this.findById);return t?t.parent.nodeItem:null}forceFilterTraverse(){this.filterTraverse(this.treeState,this.filterValue)}setInitialSelectedState(e){for(const t of e)this.options.mode===c.MultiSelect?t.nodeItem.selected&&(!t.children||0===t.children.length)&&this.toggleSelectedState(t,!0):t.nodeItem.selected&&this.toggleSelectedState(t,!0),this.setInitialSelectedState(t.children)}delete(e){for(;e.children.length>0;)this.delete(e.children.pop());this.removeSelected(e.nodeItem.item),this.remove(e),e.parent||this.deleteRoot(e,this.treeState,this.nodeItems)}toggleExpandedTraverse(e,t){for(let l of e)l.expanded=t,this.toggleExpandedTraverse(l.children,t)}deleteRoot(e,t,l){let d=l.indexOf(e.nodeItem);-1!==d&&l.splice(d,1);let r=t.indexOf(e);-1!==r&&t.splice(r,1)}isDisabled(e,t){return this.options.mode===c.NoSelect||e.disabled&&!t}addNewNode(e,t){e.parent=t,t.children.push(e),t.nodeItem.children.push(e.nodeItem),t.markSelected=f.getMarkSelected(t.nodeItem,this.options),this.options.mode===c.MultiSelect&&this.childStateChanged(t),this.filterTraverse(this.treeState,this.filterValue)}remove(e){if(e.parent){e.parent.hasFilteredChildren=!1;let t=e.parent.nodeItem.children.indexOf(e.nodeItem);-1!==t&&e.parent.nodeItem.children.splice(t,1);let l=e.parent.children.indexOf(e);-1!==l&&e.parent.children.splice(l,1);let d=e.parent.filteredChildren.indexOf(e);-1!==d&&e.parent.filteredChildren.splice(d,1)}}anyChildSelected(e){return null!=e.children.find(t=>t.selectedState===o.checked||t.selectedState===o.indeterminate)}allChildrenSelected(e){return e.children.every(t=>t.selectedState===o.checked)&&e.children.length===e.nodeItem.children.length}toggleExpandedTraverseAsc(e,t){e.expanded=t,e.parent&&this.toggleExpandedTraverseAsc(e.parent,t)}setUnchecked(e,t,l,d){if(!e.disabled||d)if(e.selectedState=o.unChecked,e.selected=!1,this.hasNoChildren(e)||l)this.removeSelected(e.nodeItem.item),!0===this.options.alwaysEmitSelected&&this.selectedItemsSubject.next(this.selectedItems),this.callbacks.unSelect&&this.callbacks.unSelect(e.nodeItem);else if(!0===t)for(const r of e.children)this.setUnchecked(r,t,l,d)}setIndeterminate(e){e.selectedState=o.indeterminate,e.selected=!1}anyActiveSelected(e){let t=e.children.filter(l=>!l.disabled&&l.selected).length>0;for(const l of e.children)!this.hasNoChildren(l)&&this.anyActiveSelected(l)&&(t=!0);return t}hasNoChildren(e){return!e.children||0===e.children.length}setChecked(e,t,l,d){if(!e.disabled||d)if(e.selectedState=o.checked,e.selected=!0,this.hasNoChildren(e)||l)this.addSelected(e);else if(!0===t)for(const r of e.children)this.setChecked(r,t,l,d)}addSelected(e){this.selectedItems.push(e.nodeItem.item),this.selectedStates.push(e),!0===this.options.alwaysEmitSelected&&this.selectedItemsSubject.next(this.selectedItems),this.callbacks.select&&this.callbacks.select(e.nodeItem)}removeSelected(e){let t=this.selectedItems.indexOf(e);-1!==t&&this.selectedItems.splice(t,1)}findById(e,t){return e.nodeItem.id===t}getNodeState(e,t,l){let d=e.find(r=>l(r,t));if(d)return d;for(let r of e)if(d=this.getNodeState(r.children,t,l),d)return d;return d}connect(){return this.selectedItemsSubject.asObservable()}applyFilter(e,t){return e.filteredChildren=this.filter(e.children,t),e.filteredChildren.length>0}filter(e,t){return e.filter(l=>!(this.options.mode===c.HideSelected&&!l.selected)&&(!(!l.hasFilteredChildren&&""!==t&&-1===l.nodeItem.name.toLowerCase().indexOf(t))||void 0))}filterTraverse(e,t){let l=[];for(let d of e)d.children.length>0&&(d.hasFilteredChildren=!1,d.hasFilteredChildren=this.filterTraverse(d.children,t),this.applyFilter(d,t)&&(d.hasFilteredChildren=!0),l.push(d.hasFilteredChildren));return l.some(d=>!0===d)}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac}),i})(),J=(()=>{class i{constructor(){this._this=this}toggleExpand(){this.state.expanded=!this.state.expanded}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=n.Xpm({type:i,selectors:[["node-icon-wrapper"]],inputs:{state:"state",nodeCollapsibleTemplate:"nodeCollapsibleTemplate"},decls:3,vars:8,consts:[[1,"node-icon-wrapper",3,"click"],[4,"ngIf"],["class","arrow-right",4,"ngIf"],["class","arrow-down",4,"ngIf"],[1,"arrow-right"],[1,"arrow-down"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.NdJ("click",function(){return t.state.expanded=!t.state.expanded}),n.YNc(1,x,2,1,"ng-container",1),n.YNc(2,b,2,5,"ng-container",1),n.qZA()),2&e&&(n.ekj("disabled",0==(null==t.state.nodeItem||null==t.state.nodeItem.children?null:t.state.nodeItem.children.length))("collapsable",(null==t.state.nodeItem||null==t.state.nodeItem.children?null:t.state.nodeItem.children.length)>0)("iconCheckbox",t.state.showCheckBox),n.xp6(1),n.Q6J("ngIf",!t.nodeCollapsibleTemplate),n.xp6(1),n.Q6J("ngIf",(null==t.state.nodeItem||null==t.state.nodeItem.children?null:t.state.nodeItem.children.length)>0))},dependencies:[a.O5,a.tP],encapsulation:2}),i})(),Z=(()=>{class i{constructor(e){this.treeService=e,this._this=this,this.active=!1}ngOnChanges(e){e.state&&(this.active=this.treeService.canToggleChildrenOnName())}nameClick(){this.treeService.nameClick(this.state)}delete(){this.treeService.deleteByState(this.state)}}return i.\u0275fac=function(e){return new(e||i)(n.Y36(p))},i.\u0275cmp=n.Xpm({type:i,selectors:[["node-name"]],inputs:{state:"state",nodeNameTemplate:"nodeNameTemplate"},features:[n.TTD],decls:3,vars:11,consts:[[1,"node-name",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.NdJ("click",function(){return t.nameClick()}),n.YNc(1,y,3,3,"ng-container",1),n.YNc(2,B,1,0,"ng-container",2),n.qZA()),2&e&&(n.ekj("markSelected",t.state.markSelected&&t.state.selected)("nodeDisabled",t.state.disabled),n.xp6(1),n.Q6J("ngIf",!t.nodeNameTemplate),n.xp6(1),n.Q6J("ngTemplateOutlet",t.nodeNameTemplate)("ngTemplateOutletContext",n.kEZ(7,O,t.state.nodeItem,t.state.nodeItem,t._this)))},dependencies:[a.O5,a.tP],encapsulation:2}),i})(),j=(()=>{class i{constructor(e){this.treeService=e,this._this=this}ngOnChanges(e){e.selectedState&&this.selectedStateChanged()}ngAfterViewInit(){this.selectedStateChanged()}selectedStateChanged(){this.nodeCheckbox&&(this.nodeCheckbox.nativeElement.indeterminate=this.selectedState===o.indeterminate,this.selectedState===o.checked?this.nodeCheckbox.nativeElement.checked=!0:this.selectedState===o.unChecked&&(this.nodeCheckbox.nativeElement.checked=!1))}checkBoxClick(){this.treeService.checkBoxClick(this.state),setTimeout(()=>{this.treeService.reEvaluateSelectedState(this.state)},1)}}return i.\u0275fac=function(e){return new(e||i)(n.Y36(p))},i.\u0275cmp=n.Xpm({type:i,selectors:[["node"]],viewQuery:function(e,t){if(1&e&&n.Gf(w,5),2&e){let l;n.iGM(l=n.CRH())&&(t.nodeCheckbox=l.first)}},inputs:{state:"state",selectedState:"selectedState",nodeNameTemplate:"nodeNameTemplate",nodeCollapsibleTemplate:"nodeCollapsibleTemplate"},features:[n.TTD],decls:6,vars:6,consts:[[1,"node"],[1,"node-container"],[3,"state","nodeCollapsibleTemplate"],["class","node-checkbox","type","checkbox",3,"disabled","checked","click",4,"ngIf"],[3,"state","nodeNameTemplate"],["class","collapsible-wrapper",3,"collapsed",4,"ngIf"],["type","checkbox",1,"node-checkbox",3,"disabled","checked","click"],["nodeCheckbox",""],[1,"collapsible-wrapper"],[1,"collapsible"],["class","node-offset",3,"state","selectedState","nodeCollapsibleTemplate","nodeNameTemplate",4,"ngFor","ngForOf"],[1,"node-offset",3,"state","selectedState","nodeCollapsibleTemplate","nodeNameTemplate"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0)(1,"div",1),n._UZ(2,"node-icon-wrapper",2),n.YNc(3,E,2,2,"input",3),n._UZ(4,"node-name",4),n.qZA(),n.YNc(5,Q,3,3,"div",5),n.qZA()),2&e&&(n.xp6(2),n.Q6J("state",t.state)("nodeCollapsibleTemplate",t.nodeCollapsibleTemplate),n.xp6(1),n.Q6J("ngIf",t.state.showCheckBox),n.xp6(1),n.Q6J("state",t.state)("nodeNameTemplate",t.nodeNameTemplate),n.xp6(1),n.Q6J("ngIf",t.state.nodeItem.children))},dependencies:[J,Z,i,a.O5,a.sg],encapsulation:2}),i})(),U=(()=>{class i{constructor(e){this.treeService=e,this.defaultOptions={mode:c.SingleSelect,checkboxes:!1,alwaysEmitSelected:!1},this.options=this.defaultOptions,this.callbacks=this.treeService.callbacks,this.filter="",this.selectedItems=new n.vpe}ngOnInit(){this.subscription=this.treeService.connect().subscribe(e=>{const t=(0,g.H)(0).subscribe(()=>{this.selectedItems.emit(e),t.unsubscribe()})})}ngOnDestroy(){this.subscription.unsubscribe()}ngOnChanges(e){e.filter&&this.treeService.filterChanged(this.filter.toLowerCase()),e.options&&(this.setOptions(),this.treeService.nodeItems&&(this.treeService.treeState=this.initTreeStructure(null,this.treeService.nodeItems,this.treeService.options),this.treeService.clear(),this.treeService.setInitialState(),this.treeService.forceFilterTraverse())),e.callbacks&&(this.treeService.callbacks=this.callbacks),e.nodeItems&&this.initialize()}addNodeById(e,t){const l=f.initState(null,e,this.options);this.treeService.addNodeById(l,t)}deleteById(e){this.treeService.deleteById(e)}editNameById(e,t){this.treeService.editNameById(e,t)}editItemById(e,t){this.treeService.editItemById(e,t)}getParentById(e){return this.treeService.getParentById(e)}expandAll(){this.treeService.toggleExpanded(!0)}collapseAll(){this.treeService.toggleExpanded(!1)}expandById(e){this.treeService.expandById(e)}collapseById(e){this.treeService.collapseById(e)}selectById(e){this.treeService.selectById(e)}initialize(){this.setOptions(),this.treeService.callbacks=this.callbacks,this.treeService.nodeItems=this.nodeItems,this.treeService.treeState=this.initTreeStructure(null,this.treeService.nodeItems,this.treeService.options),this.treeService.clear(),this.treeService.setInitialState()}initTreeStructure(e,t,l){let d=[];for(let r of t){const m=f.initState(e,r,l);r.children&&(m.children=this.initTreeStructure(m,r.children,l),m.filteredChildren=m.children),d.push(m)}return d}setOptions(){this.treeService.options=this.options.mode===c.NoSelect?Object.assign(Object.assign({},this.options),{checkboxes:!1}):Object.assign({},this.options)}}return i.\u0275fac=function(e){return new(e||i)(n.Y36(p))},i.\u0275cmp=n.Xpm({type:i,selectors:[["tree-ngx"]],contentQueries:function(e,t,l){if(1&e&&(n.Suo(l,F,5),n.Suo(l,A,5)),2&e){let d;n.iGM(d=n.CRH())&&(t.nodeNameTemplate=d.first),n.iGM(d=n.CRH())&&(t.nodeCollapsibleTemplate=d.first)}},inputs:{options:"options",callbacks:"callbacks",nodeItems:"nodeItems",filter:"filter"},outputs:{selectedItems:"selectedItems"},features:[n._Bn([p]),n.TTD],decls:2,vars:1,consts:[[1,"tree-ngx"],["class","node-root",3,"state","selectedState","nodeCollapsibleTemplate","nodeNameTemplate",4,"ngFor","ngForOf"],[1,"node-root",3,"state","selectedState","nodeCollapsibleTemplate","nodeNameTemplate"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n.YNc(1,D,1,4,"node",1),n.qZA()),2&e&&(n.xp6(1),n.Q6J("ngForOf",t.treeService.treeState))},dependencies:[j,a.sg],encapsulation:2}),i})(),W=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({providers:[p],imports:[[a.ez]]}),i})()}}]);